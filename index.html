<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
  <script src="js/jquery.timers-1.1.2.js"></script>
  <title>打字测试</title>
</head>

<script>
function create_counter(initial) {
    var x = initial || 0;
    return {
        inc: function() {
            x += 1;
            return x;
        }
    }
}


$(function(){
    var num = 0;
    var backNum = 0;
    var counter = create_counter();
    var times = 0;
    
    $('#text').keydown(function (e) {
        var key = e.which;
        if(num > 0) {
            if(key == 8) {
                num -= 1;
                backNum += 1;
            } else {
                num += 1;
            }
        } else if (num == 0) {
            if(key != 8) {
                num += 1;
            }
        }
        $("#num").text(num);
        $("#backNum").text(backNum);
    });
    
    $('body').everyTime('1s', function(){
        $("#times").text((counter.inc()).toString() + " 秒");
        times += 1;
        $("#speed").text((num * 60 / times).toFixed(0).toString() + " KPM");
    });
});
</script>

<body>
<textarea id="text"></textarea>
<p>总字数：</p>
<p id="num">0</p>

<p>退格数：</p>
<p id="backNum">0</p>

<p>花费时间：</p>
<p id="times"></p>

<p>打字速度：</p>
<p id="speed"></p>
</body>

</html>